---
import { getTranslations } from "../utils/getTranslations";
import "../styles/main.scss";

const supportedLanguages = ['en', 'uk'];
const defaultLang = 'en';
const lang = defaultLang; 
const translations = await getTranslations(lang);
---

<html lang={lang}>
  <head>
    <meta charset="UTF-8" />
    <title>{translations.redirect.initial}</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet">
    <script>
        window.addEventListener('DOMContentLoaded', () => {
          const redirectScreen = document.getElementById('redirect-screen');
          const bar = document.querySelector('.loader-fill');
          bar.style.width = '0%';
          requestAnimationFrame(() => { 
              bar.style.width = '100%'; 
          });

          // Додаємо .loaded через requestAnimationFrame після відмальовки початкового стану
          requestAnimationFrame(() => {
              redirectScreen.classList.add('loaded');
          });

          setTimeout(() => {
              document.getElementById('redirect-text').innerText =
                  document.getElementById('redirect-text').dataset.final;
          }, 1500);

          setTimeout(() => {
              sessionStorage.setItem('justRedirected', 'true');
              window.location.href = `/${lang}/`;
          }, 600);

          setTimeout(() => {
              redirectScreen.style.transition = 'opacity 0.6s ease';
              redirectScreen.style.opacity = '0';
              setTimeout(() => { 
                  window.location.href = `/${localStorage.getItem('preferredLanguage') || 'en'}/`; 
              }, 600);
          }, 4000);
      });

    </script>
  </head>
  <body>
    <div id="redirect-screen">
      <div class="logo-wrapper block w-[70px] h-[70px]relative overflow-hidden !mb-[2rem]">
        <div class="animated-bg absolute inset-0 z-0 animate-bg"></div>
        <svg class="logo-svg relative z-10 w-full h-full" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52" fill="none">
          <rect width="52" height="52" fill="url(#paint0_linear_137_3)"/>
          <path d="M32.9766 44.2481L29.528 39.1562L26.5654 44.2481H22.029L27.2598 35.8233L21.8669 27.8845H26.5654L29.9214 32.8144L32.8146 27.8845H37.3279L32.1665 36.1242L37.6751 44.2481H32.9766Z" fill="white"/>
          <path d="M10.7513 27.8845V37.3277C10.7513 38.4078 10.9905 39.2333 11.4688 39.8043C11.9626 40.3752 12.6724 40.6606 13.5982 40.6606C14.524 40.6606 15.226 40.3752 15.7044 39.8043C16.1981 39.2333 16.445 38.4078 16.445 37.3277V27.8845H20.4028V37.3277C20.4028 38.8707 20.1019 40.1746 19.5002 41.2392C18.8984 42.2885 18.0729 43.0831 17.0236 43.6232C15.9898 44.1478 14.8171 44.4101 13.5056 44.4101C12.194 44.4101 11.0368 44.1478 10.0338 43.6232C9.03087 43.0986 8.24393 42.3039 7.67302 41.2392C7.10211 40.1746 6.81665 38.8707 6.81665 37.3277V27.8845H10.7513Z" fill="white"/>
          <path d="M26.76 27.5171L29.8986 32.1277L32.6044 27.5171H37.9917L32.6048 36.1161L38.3681 44.6155H32.782L29.5516 39.8459L26.7769 44.6155H21.3688L26.8214 35.832L21.1736 27.5171H26.76ZM21.8671 27.8845L27.2598 35.8234L22.0293 44.2481H26.5656L29.5283 39.156L32.9768 44.2481H37.6753L32.1667 36.124L37.328 27.8845H32.8147L29.9215 32.8144L26.5656 27.8845H21.8671Z" fill="white"/>
          <path d="M10.7513 37.3277V27.8845H6.8166V37.3277L6.81983 37.614C6.85326 39.0326 7.13778 40.2409 7.67299 41.239C8.24388 42.3037 9.03081 43.0985 10.0337 43.6231C10.974 44.1149 12.05 44.3763 13.2616 44.407L13.5055 44.4102C14.7351 44.4102 15.8427 44.1796 16.8281 43.7185L17.0237 43.6231C18.0074 43.1168 18.7944 42.3867 19.3847 41.4328L19.5003 41.239C20.0644 40.2409 20.3641 39.0326 20.3994 37.614L20.4029 37.3277V27.8845H16.445V37.3277L16.4421 37.5272C16.4132 38.51 16.1674 39.2691 15.7045 39.8043L15.6119 39.908C15.1373 40.4097 14.466 40.6607 13.5981 40.6607V40.2933C14.444 40.2933 15.0309 40.036 15.4228 39.5682L15.4264 39.5639C15.8419 39.0835 16.0776 38.357 16.0776 37.3277V27.5171H20.7703V37.3277C20.7703 38.9177 20.46 40.2874 19.8199 41.4199L19.8189 41.422C19.1828 42.5311 18.3058 43.3766 17.1919 43.9499L17.1898 43.9506C16.098 44.5047 14.8672 44.7776 13.5055 44.7776C12.2292 44.7776 11.0794 44.5379 10.0646 44.0497L9.86365 43.9489C8.85803 43.4228 8.05835 42.6428 7.46526 41.6204L7.34938 41.4127C6.74301 40.2819 6.44922 38.9149 6.44922 37.3277V27.5171H11.1186V37.3277C11.1186 38.3573 11.3468 39.0848 11.7479 39.5654C12.1563 40.0367 12.7536 40.2933 13.5981 40.2933V40.6607L13.427 40.6571C12.5844 40.6236 11.9317 40.3395 11.4688 39.8043C11.0204 39.2691 10.7821 38.51 10.7541 37.5272L10.7513 37.3277Z" fill="white"/>
          <path d="M48.4122 6.6228V8.33554H43.8063V22.9401H41.7001V8.33554H37.0942V6.6228L48.4122 6.6228Z" fill="white"/>
          <path d="M32.6479 19.1673H25.4729L24.1073 22.94H21.8391L27.88 6.92358L30.2639 6.92358L36.2817 22.94H34.0134L32.6479 19.1673ZM32.0461 17.524L29.0604 9.28438L26.0747 17.524H32.0461Z" fill="white"/>
          <path d="M20.2467 14.7699C20.2467 16.4209 19.915 17.8636 19.2515 19.098C18.588 20.317 17.6082 21.2659 16.3121 21.9449C15.0314 22.6084 13.4884 22.9401 11.683 22.9401H6.49854L6.49854 6.6228L11.683 6.6228C13.4884 6.6228 15.0314 6.95455 16.3121 7.61804C17.6082 8.26611 18.588 9.20734 19.2515 10.4417C19.915 11.6607 20.2467 13.1034 20.2467 14.7699ZM11.521 21.0422C13.6504 21.0422 15.2782 20.4944 16.4046 19.3989C17.531 18.3034 18.0942 16.7604 18.0942 14.7699C18.0942 12.7794 17.531 11.2364 16.4046 10.1409C15.2937 9.0299 13.6658 8.47441 11.521 8.47441L8.60474 8.47441L8.60474 21.0422H11.521Z" fill="white"/>
          <!-- інші path -->
        </svg>
      </div>

      <h1 id="redirect-text" class="!mb-4" data-final={translations.redirect.final}>
        {translations.redirect.initial}
      </h1>

      <div class="loader-bar">
        <div class="loader-fill"></div>
      </div>
    </div>
  </body>
</html>
